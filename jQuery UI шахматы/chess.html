<html>
  <head>
    <meta http-equiv = "Content-Type" content = "text/html; charset=UTF-8" />
	<link rel = "stylesheet" type = "text/css" href = "jquery-ui-1.8.16.custom.css">
    <link rel = "stylesheet" type = "text/css" href = "styleChess.css">
    <script src = "jquery-1.6.2.min.js"></script>
    <script src = "jquery-ui-1.8.16.custom.min.js"></script>
  </head>
<body>
  <script>
	var step = false;
  
	function changeMove() {
		if(step) {
			$('.firstPlayer').draggable('enable');
			$('.secondPlayer').draggable('disable');
		}
		else {
			$('.firstPlayer').draggable('disable');
			$('.secondPlayer').draggable('enable');
		}
		step = !step;
	}
  
	$('<table></table>').attr('border', '1').attr('cellspacing', '0').attr('id', 'field').attr('width', '675').attr('height', '675').appendTo('body');
    var iter = 0;
	var letter = ['', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'];
	var cell = new Array(8);
	for(i = 0; i < 8; i++) cell[i] = new Array(8);
	
	for(i = 0; i < 9; i++) {
		$('<tr></tr>').appendTo('#field');
		for(j = 0; j < 9; j++) {
			$('<td></td>').appendTo('tr:last-child');
			
			if(j == 0 && i != 8) 
			    $('<div></div>').text(8 - i).addClass('side').appendTo('td:last'); 
			else if(i == 8) 
			    $('<div></div>').text(letter[j]).addClass('side').appendTo('td:last'); 
			else {
				$('td:last').css('background', i % 2 != j % 2 ? 'Wheat' : 'SaddleBrown').addClass('cell').attr('id', ++iter);
			}
		}
	}
	
	$('#field').resizable({
	    aspectRatio: true,
		resize: function(event, ui) {
			$('td').attr('height', ui.size.height / 9);
			$('td').attr('width', ui.size.height / 9);
			$('div').css('font-size', ui.size.height / 17);
		},
		stop: function(event, ui) {
			$('td').attr('height', ui.size.height / 9);
			$('td').attr('width', ui.size.height / 9);
		},
		maxWidth: 1000,
		maxHeight: 1000,
		minWidth: 250,
		minHeight: 250
	});
	
	var whiteFigures = ['♖', '♘', '♗', '♕', '♔', '♗', '♘', '♖'];
	var blackFigures = ['♜', '♞', '♝', '♚', '♛', '♝', '♞', '♜'];
	
	for(i = 1; i <= 64; i++) {
		if(1 <= i && i <= 8) 
			$('<div></div>').attr('class', 'firstPlayer').html(whiteFigures[i - 1]).appendTo('#' + i);
			
		if(9 <= i && i <= 16)
			$('<div>♟</div>').attr('class', 'firstPlayer').appendTo('#' + i);
			
		if(49 <= i && i <= 56)
			$('<div>♙</div>').attr('class', 'secondPlayer').appendTo('#' + i);
			
		if(57 <= i && i <= 64)
			$('<div></div>').attr('class', 'secondPlayer').html(blackFigures[i - 57]).appendTo('#' + i);
	}
	
	
	$('.firstPlayer').draggable({
		addClasses: false,
		revert: true,
		containment: '#field',
	});
	
	$('.secondPlayer').draggable({
		addClasses: false,
		revert: true,
		containment: '#field'
	});
	
	$('.cell').droppable({
		addClasses: false,
		tolerance: 'pointer',
		drop: function(event, ui) {
			var figure = $('#' + $(this).attr('id') + ' div');
			
			if(ui.helper.attr('class') == 'firstPlayer ui-draggable-dragging') {
				if(figure.attr('class') ==  'firstPlayer')
					return;
				if(figure.attr('class') ==  'secondPlayer ui-draggable-disabled ui-state-disabled')
					figure.remove();
				if(figure.attr('class') ==  'firstPlayer ui-draggable-dragging')
					return;
			}
				
			if(ui.helper.attr('class') == 'secondPlayer ui-draggable-dragging') {
				if(figure.attr('class') ==  'secondPlayer')
					return;
				if(figure.attr('class') ==  'firstPlayer ui-draggable-disabled ui-state-disabled')
					figure.remove();
				if(figure.attr('class') ==  'secondPlayer ui-draggable-dragging')
					return;
			}
			
			ui.helper.appendTo(this);
			ui.helper.css('top', '0px');
			ui.helper.css('left', '0px');
			changeMove();
		}
	});
	
	changeMove();
  </script>
</body>
</html> 